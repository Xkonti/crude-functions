# This compose file is for demonstration only, do not use in prod.
services:
  app:
    # Hardened image (recommended): near-zero CVEs, no shell
    # For debugging, use: xkonti/crude-functions:latest
    image: xkonti/crude-functions:hardened
    ports:
      - 8000:8000
    # Environment variables (optional)
    # environment:
    #   # Authentication configuration
    #   # Auto-detects from request headers if not set
    #   # Set explicitly when behind reverse proxy: https://your-domain.com
    #   - AUTH_BASE_URL=http://localhost:8000
    #
    # Note: All settings (log level, metrics, encryption, API access groups)
    # are configured via the web UI Settings page and stored in the database.
    # On first run, create an admin user via the web UI setup page,
    # then manage API keys through the API Keys page.
    volumes:
      # Mount the data directory for SurrealDB database and encryption keys
      - ./data:/app/data
      # Mount the code directory for function handlers
      - ./code:/app/code
    restart: unless-stopped
